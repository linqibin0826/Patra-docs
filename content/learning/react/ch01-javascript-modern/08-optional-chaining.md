---
title: å¯é€‰é“¾å’Œç©ºå€¼åˆå¹¶
chapter: 01
section: 08
status: å·²å®Œæˆ
progress:
  started_at: 2025-12-04
  completed_at: 2025-12-04
  mastery: ç†Ÿæ‚‰
tags:
  - learning/react/ch01
  - tech/javascript
  - tech/es2020
---

# å¯é€‰é“¾å’Œç©ºå€¼åˆå¹¶

> ES2020 å¼•å…¥çš„ä¸¤ä¸ªè¯­æ³•ç³–ï¼Œè®©å®‰å…¨è®¿é—®åµŒå¥—å±æ€§å’Œæä¾›é»˜è®¤å€¼å˜å¾—ç®€æ´ä¼˜é›…ã€‚åœ¨ React ä¸­å¤„ç†å¼‚æ­¥æ•°æ®å’Œå¯é€‰ props æ—¶æå…¶å¸¸ç”¨ã€‚

---

## ğŸ“‹ å­¦ä¹ ç›®æ ‡

- [x] ç†è§£ `??` å’Œ `||` çš„åŒºåˆ«ï¼ˆnullish vs falsyï¼‰
- [x] æŒæ¡ `?.` çš„ä¸‰ç§å½¢å¼ï¼šå±æ€§ã€æ–¹æ³•ã€ç´¢å¼•
- [x] ç†è§£ `?.` çš„çŸ­è·¯è¡Œä¸ºå’Œä½œç”¨èŒƒå›´
- [x] èƒ½åœ¨å®é™…åœºæ™¯ä¸­ç»„åˆä½¿ç”¨ `?.` å’Œ `??`

---

## ğŸ“– çŸ¥è¯†ç‚¹

### 1. `??` ç©ºå€¼åˆå¹¶ vs `||` é€»è¾‘æˆ–

**æ ¸å¿ƒåŒºåˆ«**ï¼šåˆ¤æ–­"ç©ºå€¼"çš„æ ‡å‡†ä¸åŒã€‚

| è¿ç®—ç¬¦ | åˆ¤æ–­æ ‡å‡† | è§¦å‘é»˜è®¤å€¼çš„æƒ…å†µ |
|--------|----------|------------------|
| `\|\|` | **falsy** | `false`ã€`0`ã€`""`ã€`null`ã€`undefined`ã€`NaN` |
| `??` | **nullish** | åªæœ‰ `null`ã€`undefined` |

```javascript
// || çš„è¡Œä¸ºï¼šé‡åˆ°ä»»ä½• falsy å€¼éƒ½ç”¨é»˜è®¤å€¼
"" || "é»˜è®¤"        // â†’ "é»˜è®¤" ğŸ˜•
0 || 100            // â†’ 100    ğŸ˜•
false || true       // â†’ true   ğŸ˜•

// ?? çš„è¡Œä¸ºï¼šåªæœ‰ null/undefined æ‰ç”¨é»˜è®¤å€¼
"" ?? "é»˜è®¤"        // â†’ ""     âœ…
0 ?? 100            // â†’ 0      âœ…
false ?? true       // â†’ false  âœ…
null ?? "é»˜è®¤"      // â†’ "é»˜è®¤" âœ…
undefined ?? "é»˜è®¤" // â†’ "é»˜è®¤" âœ…
```

> [!tip] è®°å¿†å£è¯€
> `??` ä¸¤ä¸ªé—®å· = åªé—®"æ˜¯ä¸æ˜¯ null/undefinedï¼Ÿ"

**ä½¿ç”¨åœºæ™¯**ï¼šå½“ `0`ã€`""`ã€`false` æ˜¯**æœ‰æ•ˆä¸šåŠ¡å€¼**æ—¶ï¼Œå¿…é¡»ç”¨ `??`ã€‚

```javascript
// ç”¨æˆ·æŠŠéŸ³é‡è°ƒåˆ° 0ï¼ˆé™éŸ³ï¼‰â€”â€” 0 æ˜¯æœ‰æ•ˆå€¼
const volume = userInput ?? 50;  // âœ… ä¿ç•™ 0

// ç”¨æˆ·æ¸…ç©ºäº†æ˜µç§° â€”â€” "" æ˜¯ç”¨æˆ·çš„é€‰æ‹©
const nickname = userInput ?? "åŒ¿å";  // âœ… ä¿ç•™ ""
```

---

### 2. `?.` å¯é€‰é“¾çš„ä¸‰ç§å½¢å¼

`?.` åœ¨å·¦è¾¹æ˜¯ `null` æˆ– `undefined` æ—¶**çŸ­è·¯è¿”å› `undefined`**ï¼Œä¸å†ç»§ç»­è®¿é—®ã€‚

| å½¢å¼ | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| `?.` | è®¿é—®å±æ€§ | `user?.address?.city` |
| `?.()` | è°ƒç”¨æ–¹æ³• | `user.greet?.()` |
| `?.[]` | è®¿é—®æ•°ç»„/åŠ¨æ€å±æ€§ | `arr?.[0]`ã€`obj?.[key]` |

```javascript
const user = { name: "å¼ ä¸‰" };  // æ²¡æœ‰ addressã€greetã€hobbies

// å±æ€§è®¿é—®
user?.address?.city       // â†’ undefinedï¼ˆå®‰å…¨ï¼‰

// æ–¹æ³•è°ƒç”¨
user.greet?.()            // â†’ undefinedï¼ˆå®‰å…¨ï¼‰

// æ•°ç»„ç´¢å¼•
user.hobbies?.[0]         // â†’ undefinedï¼ˆå®‰å…¨ï¼‰
```

---

### 3. `?.` çš„ä½œç”¨èŒƒå›´ï¼ˆé‡è¦é™·é˜±ï¼ï¼‰

`?.` **åªä¿æŠ¤å®ƒå·¦è¾¹é‚£ä¸€ä¸ªä½ç½®**ï¼Œä¸ä¼šè‡ªåŠ¨ä¿æŠ¤æ•´æ¡é“¾ï¼

```
user?.address.city
      â”‚       â”‚
      â”‚       â””â”€â”€ âŒ è¿™é‡Œæ²¡æœ‰ä¿æŠ¤ï¼
      â”‚
      â””â”€â”€ âœ… åªä¿æŠ¤äº†è¿™é‡Œ
```

```javascript
const user = { name: "å¼ ä¸‰" };  // å­˜åœ¨ï¼Œä½†æ²¡æœ‰ address

// âŒ å±é™©ï¼šaddress æ˜¯ undefinedï¼Œ.city ä¼šæŠ¥é”™
user?.address.city   // ğŸ’¥ TypeError!

// âœ… å®‰å…¨ï¼šæ¯ä¸€å±‚éƒ½åŠ  ?.
user?.address?.city  // â†’ undefined
```

> [!warning] å¸¸è§é”™è¯¯
> è®¤ä¸º `user?.` ä¼šä¿æŠ¤åé¢æ‰€æœ‰çš„å±æ€§è®¿é—®ã€‚å®é™…ä¸Šæ¯ä¸ªå¯èƒ½ä¸ºç©ºçš„ä½ç½®éƒ½éœ€è¦å•ç‹¬åŠ  `?.`ã€‚

---

### 4. ç»„åˆä½¿ç”¨ï¼š`?.` + `??`

æœ€å¸¸è§çš„æ¨¡å¼ï¼š**å®‰å…¨è®¿é—® + æä¾›é»˜è®¤å€¼**ã€‚

```javascript
// ä» API å“åº”ä¸­å®‰å…¨æå–æ•°æ®
const displayName = response?.data?.user?.profile?.name ?? "è®¿å®¢";
const avatar = response?.data?.user?.avatar ?? "/default.png";
```

**æ‰§è¡Œæµç¨‹**ï¼š

```
response?.data?.user?.profile?.name ?? "è®¿å®¢"
         â”‚     â”‚     â”‚        â”‚
         â–¼     â–¼     â–¼        â–¼
      ä»»ä½•ä¸€å±‚æ˜¯ null/undefined â†’ è¿”å› undefined
                                      â”‚
                                      â–¼
                           undefined ?? "è®¿å®¢" â†’ "è®¿å®¢"
```

---

### 5. `&&` çŸ­è·¯ç”¨äºæ¡ä»¶æ‰§è¡Œ

`&&` ä¸åªæ˜¯é€»è¾‘ä¸ï¼Œè¿˜å¸¸ç”¨äº**æ¡ä»¶æ‰§è¡Œ**â€”â€”å‰é¢ä¸ºçœŸæ‰æ‰§è¡Œåé¢ã€‚

```javascript
// åœºæ™¯ï¼šåªæœ‰å­˜åœ¨ error æ—¶æ‰æ ¼å¼åŒ–é”™è¯¯ä¿¡æ¯
const errorMsg = error && `[${error.code}] ${error.message}`;
// error ä¸å­˜åœ¨ â†’ è¿”å› undefinedï¼ˆçŸ­è·¯ï¼‰
// error å­˜åœ¨   â†’ è¿”å›æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²
```

**`&&` vs `??` çš„åŒºåˆ«**ï¼š

| è¿ç®—ç¬¦ | ç”¨é€” | æ€ç»´æ¨¡å¼ |
|--------|------|----------|
| `??` | æä¾›å¤‡é€‰å€¼ | "å¦‚æœæ˜¯ç©ºï¼Œå°±ç”¨è¿™ä¸ª" |
| `&&` | æ¡ä»¶æ‰§è¡Œ | "å¦‚æœå­˜åœ¨ï¼Œæ‰æ‰§è¡Œè¿™ä¸ª" |

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. React ç»„ä»¶ä¸­çš„å…¸å‹ç”¨æ³•

```tsx
function UserProfile({ user }) {
  return (
    <div>
      {/* å®‰å…¨è®¿é—® + é»˜è®¤å€¼ */}
      <img src={user?.avatar ?? "/default-avatar.png"} />
      <h1>{user?.name ?? "åŠ è½½ä¸­..."}</h1>
      <p>åŸå¸‚ï¼š{user?.address?.city ?? "æœªå¡«å†™"}</p>

      {/* æ¡ä»¶æ¸²æŸ“ */}
      {user?.bio && <p className="bio">{user.bio}</p>}

      {/* å®‰å…¨è°ƒç”¨æ–¹æ³• */}
      <button onClick={() => user?.onLogout?.()}>é€€å‡º</button>
    </div>
  );
}
```

### 2. ä¸ Java Optional çš„å¯¹æ¯”

```java
// Java: é“¾å¼ map + orElse
Optional.ofNullable(user)
    .map(User::getAddress)
    .map(Address::getCity)
    .orElse("æœªçŸ¥");
```

```javascript
// JavaScript: ?. + ??
user?.address?.city ?? "æœªçŸ¥"
```

---

## ğŸ“Š è¿ç®—ç¬¦é€ŸæŸ¥è¡¨

| è¿ç®—ç¬¦ | åç§° | ä½œç”¨ | è®°å¿†ç‚¹ |
|--------|------|------|--------|
| `?.` | å¯é€‰é“¾ | å®‰å…¨è®¿é—®å±æ€§/æ–¹æ³•/ç´¢å¼• | "é—®ä¸€é—®å†è®¿é—®" |
| `??` | ç©ºå€¼åˆå¹¶ | åªä¸º null/undefined æä¾›é»˜è®¤å€¼ | "åŒé—®å·åªé—®ç©º" |
| `\|\|` | é€»è¾‘æˆ– | ä¸ºæ‰€æœ‰ falsy å€¼æä¾›é»˜è®¤å€¼ | "å•ç«–çº¿ç®¡å¾—å®½" |
| `&&` | é€»è¾‘ä¸ | æ¡ä»¶æ‰§è¡Œï¼ˆçŸ­è·¯ï¼‰ | "éƒ½çœŸæ‰ç»§ç»­" |

---

## âœï¸ ç»ƒä¹ 

å®Œæˆç»ƒä¹ å¹¶è¿è¡Œæµ‹è¯•éªŒè¯ï¼š

| ç»ƒä¹ æ–‡ä»¶ | éªŒè¯å‘½ä»¤ |
|----------|----------|
| [08-optional-chaining.tsx](idea://open?file=/Users/linqibin/Desktop/Patra/patra-react-playground/src/exercises/ch01/08-optional-chaining.tsx) | `pnpm test 08-optional-chaining` |

### ç»ƒä¹ è¦ç‚¹å›é¡¾

| ç»ƒä¹  | è¸©è¿‡çš„å‘ | æ­£ç¡®åšæ³• |
|------|----------|----------|
| safeGreet | `user.greet()` ç›´æ¥è°ƒç”¨ä¼šæŠ¥é”™ | `user.greet?.()` å¯é€‰è°ƒç”¨ |
| extractErrorMessage | æ‹¼æ¥å­—ç¬¦ä¸²ä¼šå¾—åˆ° `"[undefined]undefined"` | ç”¨ `&&` çŸ­è·¯ï¼Œä¸å­˜åœ¨æ—¶è¿”å› undefined |

---

## ğŸ§ª æµ‹éªŒ

### Q1: ä»¥ä¸‹ä»£ç è¾“å‡ºä»€ä¹ˆï¼Ÿ

```javascript
const config = { retries: 0 };
const retries = config.retries || 3;
console.log(retries);
```

- [ ] A. `0`
- [x] B. `3`
- [ ] C. `undefined`
- [ ] D. æŠ¥é”™

> [!success]- æŸ¥çœ‹ç­”æ¡ˆ
> **ç­”æ¡ˆï¼šB**
>
> `0` æ˜¯ falsy å€¼ï¼Œ`||` ä¼šç”¨å³è¾¹çš„é»˜è®¤å€¼ `3`ã€‚å¦‚æœæƒ³ä¿ç•™ `0`ï¼Œåº”è¯¥ç”¨ `??`ã€‚

### Q2: ä»¥ä¸‹ä»£ç è¾“å‡ºä»€ä¹ˆï¼Ÿ

```javascript
const user = { profile: { name: "" } };
const name = user?.profile?.name ?? "åŒ¿å";
console.log(name);
```

- [x] A. `""`ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰
- [ ] B. `"åŒ¿å"`
- [ ] C. `undefined`
- [ ] D. æŠ¥é”™

> [!success]- æŸ¥çœ‹ç­”æ¡ˆ
> **ç­”æ¡ˆï¼šA**
>
> `?.` æˆåŠŸè®¿é—®åˆ° `name`ï¼ˆå€¼ä¸º `""`ï¼‰ï¼Œ`??` åªåœ¨ null/undefined æ—¶æ‰ç”¨é»˜è®¤å€¼ï¼Œç©ºå­—ç¬¦ä¸²ä¸è§¦å‘ã€‚

### Q3: ä»¥ä¸‹ä»£ç è¾“å‡ºä»€ä¹ˆï¼Ÿ

```javascript
const data = { items: null };
const first = data?.items?.[0] ?? "æ— ";
console.log(first);
```

- [ ] A. `null`
- [x] B. `"æ— "`
- [ ] C. `undefined`
- [ ] D. æŠ¥é”™

> [!success]- æŸ¥çœ‹ç­”æ¡ˆ
> **ç­”æ¡ˆï¼šB**
>
> `data.items` æ˜¯ `null`ï¼Œ`items?.` çŸ­è·¯è¿”å› `undefined`ï¼Œç„¶å `undefined ?? "æ— "` è¿”å› `"æ— "`ã€‚

---

## ğŸ”— å¯¼èˆª

- ä¸Šä¸€èŠ‚ï¼š[[07-array-methods|æ•°ç»„é«˜é˜¶æ–¹æ³•]]
- ä¸‹ä¸€èŠ‚ï¼š[[99-summary|ç« èŠ‚æ€»ç»“]]
